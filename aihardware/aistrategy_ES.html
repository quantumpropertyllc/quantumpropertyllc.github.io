<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hoja de Ruta de Estrategia de IA | Queen City AI</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #007AFF;
            --secondary: #AF52DE;
            --background: #000000;
            --surface: rgba(255, 255, 255, 0.08);
            --card-bg: #121212;
            --border: rgba(255, 255, 255, 0.15);
            --text: #ffffff;
            --text-dim: rgba(255, 255, 255, 0.7);
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Outfit', sans-serif;
            background-color: var(--background);
            color: var(--text);
            overflow-x: hidden;
            background-image:
                radial-gradient(circle at 0% 0%, rgba(0, 122, 255, 0.2), transparent 50%),
                radial-gradient(circle at 100% 100%, rgba(175, 82, 222, 0.15), transparent 50%);
            background-attachment: fixed;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 24px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding-top: 20px;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .subtitle {
            font-size: 14px;
            color: var(--text-dim);
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        /* Survey Steps */
        .card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 32px;
            padding: 32px;
            margin-bottom: 24px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            font-size: 24px;
            font-weight: 600;
            margin: 0 0 16px 0;
            line-height: 1.3;
        }

        .description {
            font-size: 15px;
            color: var(--text-dim);
            margin-bottom: 32px;
            line-height: 1.5;
            display: block;
            /* Ensure it's not hidden */
        }

        .options-grid {
            display: grid;
            gap: 12px;
        }

        .option-btn {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 16px 20px;
            color: var(--text);
            font-size: 16px;
            font-family: inherit;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .option-btn:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--primary);
        }

        .option-btn.selected {
            background: var(--primary);
            border-color: var(--primary);
            font-weight: 600;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: auto;
            padding-bottom: 20px;
        }

        .btn-secondary {
            background: transparent;
            border: none;
            color: var(--text-dim);
            font-size: 16px;
            cursor: pointer;
            padding: 12px;
        }

        .progress-bar {
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            transition: width 0.4s ease;
        }

        /* Results Screen */
        .results-header {
            text-align: left;
            margin-bottom: 24px;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 100px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .badge-ai {
            background: rgba(175, 82, 222, 0.2);
            color: var(--secondary);
            border: 1px solid rgba(175, 82, 222, 0.3);
        }

        .badge-hw {
            background: rgba(0, 122, 255, 0.2);
            color: var(--primary);
            border: 1px solid rgba(0, 122, 255, 0.3);
        }

        .result-item {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 24px;
            padding: 24px;
            margin-bottom: 16px;
            border: 1px solid var(--border);
        }

        .result-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .result-subtitle {
            font-size: 13px;
            color: var(--text-dim);
            margin-bottom: 16px;
        }

        .justification {
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-dim);
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px dashed var(--border);
        }

        .action-container {
            margin-top: 32px;
            display: grid;
            gap: 12px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 16px;
            padding: 18px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            box-shadow: 0 8px 24px rgba(0, 122, 255, 0.3);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text);
            border-radius: 16px;
            padding: 18px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
        }

        .roi-card {
            background: linear-gradient(135deg, rgba(52, 199, 89, 0.1), transparent);
            border: 1px solid rgba(52, 199, 89, 0.2);
            padding: 24px;
            border-radius: 24px;
            margin-top: 24px;
        }

        .roi-value {
            font-size: 32px;
            font-weight: 700;
            color: #34C759;
            margin: 4px 0;
        }

        .disclaimer {
            font-size: 10px;
            color: var(--text-dim);
            text-align: center;
            margin-top: 24px;
        }

        #loading {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--background);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>

<body>
    <div id="loading">
        <div class="spinner"></div>
    </div>

    <div class="container">
        <header>
            <div class="logo">Estrategia QCAI</div>
            <div class="subtitle">Hoja de Ruta de Adopción de IA</div>
        </header>

        <div class="progress-bar">
            <div id="progress" class="progress-fill" style="width: 10%;"></div>
        </div>

        <div id="survey-container">
            <!-- Questions will be injected here -->
        </div>

        <div class="nav-buttons" id="nav-container">
            <button class="btn-secondary" onclick="prevStep()" id="prev-btn" style="visibility: hidden;">Atrás</button>
        </div>
    </div>

    <script>
        let catalog = null;
        let currentStep = 0;
        const responses = {};

        const questions = [
            {
                id: 'businessType',
                title: '¿Cuál es su enfoque principal?',
                desc: 'Adaptamos los modelos según la profundidad de razonamiento de la industria.',
                options: [
                    { label: 'Legal / Finanzas / Cumplimiento', value: 'legal' },
                    { label: 'Ingeniería de Software / Tecnología', value: 'tech' },
                    { label: 'Creativo / Marketing', value: 'creative' },
                    { label: 'Operaciones Empresariales', value: 'enterprise' },
                    { label: 'Uso Personal / Individual', value: 'personal' }
                ]
            },
            {
                id: 'aiGoals',
                title: '¿Objetivo principal de IA?',
                desc: 'Seleccione la tarea principal que desea automatizar.',
                options: [
                    { label: 'Razonamiento y Análisis Avanzado', value: 'reasoning' },
                    { label: 'Codificación y Tareas Técnicas', value: 'coding' },
                    { label: 'Redacción de Contenido y RAG', value: 'writing' },
                    { label: 'Visión / OCR / Análisis de Imagen', value: 'vision' }
                ]
            },
            {
                id: 'privacy',
                title: '¿Requisito de Privacidad de Datos?',
                desc: 'Determina si necesita hardware local o APIs en la nube.',
                options: [
                    { label: 'Estrictamente Local (Datos Privados)', value: 'local' },
                    { label: 'Híbrido (Datos Mixtos)', value: 'hybrid' },
                    { label: 'Nube Aceptable (No Sensible)', value: 'cloud' }
                ]
            },
            {
                id: 'inputSize',
                title: '¿Tamaño Típico del Documento?',
                desc: 'Afecta la "Ventana de Contexto" del modelo recomendado.',
                options: [
                    { label: 'Consultas Cortas (1-5 páginas)', value: 'standard' },
                    { label: 'Medio (10-50 páginas)', value: 'medium' },
                    { label: 'Grande (Libros, Bases de Código enteras)', value: 'largeDocs' }
                ]
            },
            {
                id: 'accuracyLevel',
                title: '¿Precisión Requerida?',
                desc: 'Determina el nivel de "Cuantización" y el uso de memoria.',
                options: [
                    { label: 'Alta Precisión (Científico/Legal)', value: 'High-Precision' },
                    { label: 'Equilibrado (Uso Diario Pro)', value: 'Balanced' },
                    { label: 'Rápido (Borradores/Creativo)', value: 'Fast' }
                ]
            },
            {
                id: 'platformPreference',
                title: '¿Ecosistema de Hardware Existente?',
                desc: 'Nos ayuda a coincidir con la arquitectura de GPU compatible.',
                options: [
                    { label: 'Apple Silicon (Mac)', value: 'mac' },
                    { label: 'NVIDIA (Windows/Linux)', value: 'nvidia' },
                    { label: 'AMD (Windows/Linux)', value: 'amd' },
                    { label: 'Sin Preferencia / Nueva Configuración', value: 'none' }
                ]
            },
            {
                id: 'teamSize',
                title: '¿Escala Operativa?',
                desc: 'Determina las necesidades de ancho de banda de memoria para la concurrencia.',
                options: [
                    { label: 'Especialista Individual', value: 'solo' },
                    { label: 'Equipo Pequeño (2-10)', value: 'smallTeam' },
                    { label: 'Departamento Empresarial', value: 'enterprise' }
                ]
            },
            {
                id: 'roleToReplace',
                title: '¿Rol Principal a Automatizar?',
                desc: 'Utilizado para calcular el Retorno de Inversión (ROI) realista.',
                options: [
                    { label: 'Administrativo / Soporte (~$45k/año)', value: 'admin' },
                    { label: 'Contador / Analista (~$75k/año)', value: 'analyst' },
                    { label: 'Especialista Técnico/Legal (~$120k/año)', value: 'specialist' }
                ]
            },
            {
                id: 'headcountReplaced',
                title: '¿Número de Personas Reemplazadas?',
                desc: '¿Cuánto trabajo humano compensará esta IA?',
                options: [
                    { label: 'Parcial / Asistente (0.5 personas)', value: 'half' },
                    { label: '1 Empleado de Tiempo Completo (1 persona)', value: 'one' },
                    { label: 'Equipo Pequeño (2-3 personas)', value: 'few' },
                    { label: 'Departamento / Agencia (4+ personas)', value: 'many' }
                ]
            }
        ];

        async function init() {
            try {
                // Cache buster for mobile webviews
                const res = await fetch('catalog.json?v=' + Date.now());
                if (!res.ok) throw new Error(`HTTP ${res.status}`);
                catalog = await res.json();
                document.getElementById('loading')?.classList.add('hidden');
                renderStep();
            } catch (e) {
                console.error('Failed to load catalog', e);
                document.getElementById('survey-container').innerHTML = `
                    <div class="card" style="text-align:center; border-color: #ff3b30;">
                        <h1 style="color:#ff3b30">Error de Carga</h1>
                        <p class="description">No se pudo cargar el catálogo de hardware. Por favor verifique su conexión a internet.</p>
                        <p style="font-size:12px; opacity:0.5">${e.message}</p>
                        <button class="btn-primary" onclick="location.reload()" style="margin-top:20px">Reintentar Ahora</button>
                    </div>
                `;
            }
        }

        function renderStep() {
            const container = document.getElementById('survey-container');
            const q = questions[currentStep];

            // Progress
            const progress = ((currentStep + 1) / questions.length) * 100;
            document.getElementById('progress').style.width = progress + '%';
            document.getElementById('prev-btn').style.visibility = currentStep > 0 ? 'visible' : 'hidden';

            container.innerHTML = `
                <div class="card">
                    <h1>${q.title}</h1>
                    <p class="description">${q.desc}</p>
                    <div class="options-grid">
                        ${q.options.map(opt => `
                            <button class="option-btn ${responses[q.id] === opt.value ? 'selected' : ''}" 
                                    onclick="selectOption('${q.id}', '${opt.value}')">
                                ${opt.label}
                                <span>→</span>
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function selectOption(id, value) {
            responses[id] = value;

            // Check if we should skip hardware/platform questions for cloud users
            if (id === 'privacy' && value === 'cloud') {
                // Future optimization: maybe skip some steps. 
                // For now, let user finish to get full recommendation.
            }

            if (currentStep < questions.length - 1) {
                currentStep++;
                renderStep();
            } else {
                showResults();
            }
        }

        function prevStep() {
            if (currentStep > 0) {
                currentStep--;
                renderStep();
            }
        }

        function showResults() {
            document.getElementById('progress').style.width = '100%';
            document.getElementById('nav-container').classList.add('hidden');

            const result = calculateRecommendation();
            const container = document.getElementById('survey-container');

            container.innerHTML = `
                <div class="results-header">
                    <span class="badge badge-ai">Estrategia Desbloqueada</span>
                    <h1>Tu Hoja de Ruta de IA</h1>
                    <p class="description">Basado en enfoque ${responses.businessType} y necesidades de privacidad ${responses.privacy}.</p>
                </div>

                <div class="result-item">
                    <div class="result-subtitle">MODELO RECOMENDADO</div>
                    <div class="result-title">${result.model.name}</div>
                    <p class="description" style="margin-bottom:0">Modelo ${result.model.family} • Especificaciones ${result.model.parameter_size}</p>
                    <div class="justification">${result.modelJustification}</div>
                </div>

                <div class="result-item">
                    <div class="result-subtitle">ARQUITECTURA DE HARDWARE</div>
                    <div class="result-title">${result.hardware.name}</div>
                    <p class="description" style="margin-bottom:8px">${result.hardware.gpu} • ${result.hardware.vram}GB VRAM</p>
                    <div class="justification">${result.hwJustification}</div>
                </div>

                ${result.cloudRecs ? `
                <div class="result-item" style="border: 1px solid var(--secondary); background: rgba(175, 82, 222, 0.05);">
                    <div class="result-subtitle" style="color:var(--secondary)">INFRAESTRUCTURA DE NUBE Y PRIVADA</div>
                    <div class="options-grid" style="margin-top:16px">
                        ${result.cloudRecs.map(p => `
                            <a href="${p.url}" target="_blank" class="option-btn" style="text-decoration:none; display:flex; align-items:center;">
                                <div>
                                    <div style="font-weight:700; color:var(--text)">${p.name}</div>
                                    <div style="font-size:12px; color:var(--text-dim)">${p.description}</div>
                                    ${p.provider ? `<div style="font-size:11px; color:var(--secondary); margin-top:4px">vía ${p.provider}</div>` : ''}
                                </div>
                                <span style="color:var(--secondary)">↗</span>
                            </a>
                        `).join('')}
                    </div>
                    <div class="justification">
                        <strong style="color:var(--text)">Recomendación Híbrida/Nube:</strong> <br>
                        Para entrenamiento escalable o infraestructura gestionada, recomendamos <strong>Lambda Labs</strong> (GPUs en la Nube) y <strong>Puget Systems</strong> (Servidores Personalizados).
                    </div>
                </div>
                ` : ''}

                <div class="roi-card">
                    <div class="result-subtitle" style="color:#34C759">ROI ANUAL ESTIMADO</div>
                    <div class="roi-value">$${result.savings.toLocaleString()}</div>
                    <p class="description" style="margin-bottom:12px">Período de Recuperación de Hardware: ~${result.payback} Meses</p>
                    <div class="justification" style="border-top-color: rgba(52, 199, 89, 0.2); font-size: 13px;">
                        <strong>Acerca de este cálculo:</strong><br>
                        • Base Asumida: <strong>${result.roleDisplay} ($${result.salaryBase.toLocaleString()}/año)</strong>.<br>
                        • Personal Compensado: <strong>${result.headcountDisplay}</strong>.<br>
                        • Compara el costo inicial del hardware de <strong>$${result.hardware.price.toLocaleString()}</strong> con los ahorros salariales recurrentes.<br>
                    </div>
                </div>

                <div class="action-container">
                    <a href="${result.hardware.purchase_url}" target="_blank" class="btn-primary">Comprar Hardware Recomendado</a>
                    <a href="https://quantumpropertyllc.github.io/aihardware/diy.html?template=${result.hardware.diy_template}" class="btn-outline">Ver Guía de Montaje DIY</a>
                    <a href="mailto:admin@queencityai.net?subject=Professional%20AI%20Installation%20Request&body=I%20am%20interested%20in%20deploying%20the%20${result.model.name}%20architecture." class="btn-outline">Solicitar Instalación Profesional</a>
                </div>

                <p class="disclaimer">Como Asociado de Amazon, ganamos con las compras que califican. Esto apoya nuestra investigación de IA de código abierto.</p>
                <div style="height:100px"></div>
            `;
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function calculateRecommendation() {
            // 1. Model Selection
            let models = catalog.ai_models;
            let model = null;

            // Context window priority
            if (responses.inputSize === 'largeDocs') {
                model = models.find(m => m.id.includes('scout')) || models.find(m => m.context_window >= 200000) || models.find(m => m.parameters >= 600);
            }

            if (!model) {
                if (['legal', 'enterprise'].includes(responses.businessType)) {
                    model = models.find(m => m.id.includes('qwen')) || models.find(m => m.parameters >= 600) || models.find(m => m.parameters >= 70);
                } else if (responses.aiGoals === 'coding') {
                    model = models.find(m => m.id.includes('qwen')) || models.find(m => m.id.includes('coder')) || models.find(m => m.id.includes('deepseek'));
                } else if (responses.aiGoals === 'vision') {
                    model = models.find(m => m.id.includes('qwen')) || models.find(m => m.id.includes('vision')) || models.find(m => m.id.includes('ministral'));
                }
            }

            if (!model) {
                if (responses.accuracyLevel === 'Fast' || (responses.businessType === 'personal' && responses.accuracyLevel === 'Balanced')) {
                    model = models.find(m => m.parameters <= 12);
                } else {
                    model = responses.accuracyLevel === 'High-Precision'
                        ? [...models].sort((a, b) => b.parameters - a.parameters)[0]
                        : [...models].sort((a, b) => a.parameters - b.parameters)[0];
                }
            }

            // 2. VRAM Math
            const ratio = responses.accuracyLevel === 'High-Precision' ? 1.2 : (responses.accuracyLevel === 'Balanced' ? 0.9 : 0.75);
            const overhead = responses.accuracyLevel === 'High-Precision' ? 1.2 : (responses.accuracyLevel === 'Balanced' ? 1.15 : 1.1);
            const vramNeeded = Math.ceil((model.parameters * ratio) * overhead);

            // 3. Bandwidth
            const bandwidthNeeded = responses.teamSize === 'enterprise' ? 800 : (responses.teamSize === 'smallTeam' ? 500 : 250);

            // 4. Hardware Match
            let candidates = catalog.hardware_bundles.filter(b => b.vram >= vramNeeded && b.memory_bandwidth >= bandwidthNeeded);
            if (candidates.length === 0) candidates = catalog.hardware_bundles.filter(b => b.vram >= vramNeeded);

            const pref = responses.platformPreference.toLowerCase();
            let filtered = candidates;
            if (pref === 'mac') filtered = candidates.filter(b => b.name.includes('Mac') || b.gpu.includes('Apple'));
            else if (pref === 'nvidia') filtered = candidates.filter(b => b.gpu.includes('NVIDIA') || b.gpu.includes('RTX'));
            else if (pref === 'amd') filtered = candidates.filter(b => b.gpu.includes('AMD') || b.gpu.includes('Radeon'));

            if (filtered.length > 0) candidates = filtered;
            candidates.sort((a, b) => a.price - b.price);
            const hardware = candidates[0] || catalog.hardware_bundles[catalog.hardware_bundles.length - 1];

            // 5. Justifications
            let modelJust = `Optimizado para ${model.name} para equilibrar velocidad e inteligencia.`;
            if (['legal', 'enterprise'].includes(responses.businessType)) modelJust = `Seleccionado ${model.name} por la alta profundidad de razonamiento requerida en ${responses.businessType}.`;
            else if (responses.aiGoals === 'coding') modelJust = `Eligiendo ${model.name} basado en puntos de referencia de codificación de primer nivel.`;

            const hwJust = `Ejecutar este modelo en ${responses.accuracyLevel.toLowerCase()} requiere ~${vramNeeded}GB VRAM. Esta configuración ${hardware.name} proporciona el ancho de banda necesario de ${hardware.memory_bandwidth}GB/s para la escala ${responses.teamSize}.`;

            // 6. ROI Math based on substituted roles
            let salaryBase = 75000;
            let roleDisplay = "Contador / Analista";
            if (responses.roleToReplace === 'admin') { salaryBase = 45000; roleDisplay = "Administrativo / Soporte"; }
            else if (responses.roleToReplace === 'specialist') { salaryBase = 120000; roleDisplay = "Especialista Técnico / Legal"; }

            let headcountMult = 1;
            let headcountDisplay = "1 Empleado de Tiempo Completo";
            if (responses.headcountReplaced === 'half') { headcountMult = 0.5; headcountDisplay = "0.5 Empleados (Asistente)"; }
            else if (responses.headcountReplaced === 'few') { headcountMult = 2.5; headcountDisplay = "2-3 Empleados"; }
            else if (responses.headcountReplaced === 'many') { headcountMult = 4.0; headcountDisplay = "4+ Empleados"; }

            const savings = salaryBase * headcountMult; // Total operational salary savings
            const payback = Math.round((hardware.price / (savings / 12)) * 10) / 10;

            // 7. Cloud/Private Recommendations
            let cloudRecs = null;
            if (['cloud', 'hybrid'].includes(responses.privacy) && catalog.cloud_providers) {
                // Filter to only show relevant ones (e.g., exclude public cloud for 'strict' private if we had that)
                // For now, show all 3 (Public, Lambda, Puget) as options
                cloudRecs = catalog.cloud_providers;
            }

            return {
                model, hardware, modelJustification: modelJust, hwJustification: hwJust,
                savings, payback, cloudRecs, roleDisplay, salaryBase, headcountDisplay
            };
        }

        init();
    </script>
</body>

</html>